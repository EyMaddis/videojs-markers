/*! videojs-markers - v1.1.0 - 2016-09-28
* Copyright (c) 2016 ; Licensed  */
"use strict";!function(a,b,c){function d(){var a=(new Date).getTime(),b="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(b){var c=(a+16*Math.random())%16|0;return a=Math.floor(a/16),("x"==b?c:3&c|8).toString(16)});return b}function e(b){function c(){t.sort(function(a,b){return r.markerTip.time(a)-r.markerTip.time(b)})}function e(b){a.each(b,function(a,b){b.key=b.key||d(),u.find(".vjs-progress-holder").append(h(b)),s[b.key]=b,t.push(b)}),c()}function g(a){return r.markerTip.time(a)/w.duration()*100}function h(b,c){var d=a("<div class='vjs-marker'></div>");return d.css(r.markerStyle).css({"margin-left":-parseFloat(d.css("width"))/2+"px",left:g(b)+"%"}).attr("data-marker-key",b.key).attr("data-marker-time",r.markerTip.time(b)),b.class&&d.addClass(b.class),d.on("click",function(c){var d=!1;if("function"==typeof r.onMarkerClick&&(d=0==r.onMarkerClick(b)),!d){var e=a(this).data("marker-key");w.currentTime(r.markerTip.time(s[e]))}}),r.markerTip.display&&k(d,b),d}function i(){for(var a=0;a<t.length;a++){var b=t[a],d=u.find(".vjs-marker[data-marker-key='"+b.key+"']"),e=u.find(".vjs-tip[data-marker-key='"+b.key+"']"),f=r.markerTip.time(b);if(d.data("marker-time")!=f){var h=g(b)+"%";d.css({left:h}).attr("data-marker-time",f),e&&e.css("left",h)}}c()}function j(a){x&&(y=-1,x.css("visibility","hidden")),v=-1;for(var b=0;b<a.length;b++){var d=a[b],e=t[d];e&&(delete s[e.key],t[d]=null,u.find(".vjs-marker[data-marker-key='"+e.key+"']").remove(),u.find(".vjs-tip[data-marker-key='"+e.key+"']").remove())}for(var b=t.length-1;b>=0;b--)null===t[b]&&t.splice(b,1);c()}function k(a,b){var c=l(b),d=c.find(".vjs-tip-inner");c.css({left:g(b)+"%","margin-left":-parseFloat(c.css("width"))/2-5+"px",visibility:"visible"});var e=function(a){c.addClass("vjs-marker-hovered")},f=function(){c.removeClass("vjs-marker-hovered")};d.on("click",function(){r.markerTip.clickable&&w.currentTime(b.time)}),c.on("mouseover",e).on("mouseout",f),a.on("mouseover",e).on("mouseout",f)}function l(b){var c=a("<div class='vjs-tip'><div class='vjs-tip-inner'></div></div>");if(b){var d=c.find(".vjs-tip-inner");d.text(r.markerTip.text(b)),c.data("markerKey",b.key),c.attr("data-marker-key",b.key),b.class&&d.addClass(b.class)}return u.find(".vjs-progress-holder").append(c),c}function m(a){if(!(v<0)&&x){var b=t[v],c=r.markerTip.time(b);a>=c&&a<=c+r.breakOverlay.displayTime?(y!=v&&(y=v,x.find(".vjs-break-overlay-text").text(r.breakOverlay.text(b))),x.css("visibility","visible")):(y=-1,x.css("visibility","hidden"))}}function n(){x=a("<div class='vjs-break-overlay'><div class='vjs-break-overlay-text'></div></div>").css(r.breakOverlay.style),u.append(x),y=-1}function o(){p(),m()}function p(){var a,c=function(a){return a<t.length-1?r.markerTip.time(t[a+1]):w.duration()},d=w.currentTime(),e=-1;if(v!=-1){a=c(v);var f=t[v],g=r.markerTip.time(f);if(d>=g+r.activeHighlightTimeout&&(u.find(".vjs-marker[data-marker-key='"+f.key+"']").removeClass("vjs-marker-active"),u.find(".vjs-tip[data-marker-key='"+f.key+"']").removeClass("vjs-marker-active")),d>=g&&d<a)return}if(t.length>0&&d<r.markerTip.time(t[0]))e=-1;else for(var h=0;h<t.length;h++)if(a=c(h),d>=r.markerTip.time(t[h])&&d<a){e=h;break}if(e!=v){var i=t[e];if(u.find(".vjs-marker").removeClass("vjs-marker-active"),u.find(".vjs-tip").removeClass("vjs-marker-active"),i){var j=u.find(".vjs-marker[data-marker-key='"+i.key+"']"),k=u.find(".vjs-tip[data-marker-key='"+i.key+"']");j.addClass("vjs-marker-active"),k.addClass("vjs-marker-active")}e!=-1&&b.onMarkerReached&&b.onMarkerReached(t[e]),v=e}}function q(){w.markers.removeAll(),e(b.markers),r.breakOverlay.display&&n(),o(),w.on("timeupdate",o)}var r=a.extend(!0,{},f,b),s={},t=[],u=a(this.el()),v=-1,w=this,x=null,y=-1;w.on("loadedmetadata",function(){q()}),w.markers={getMarkers:function(){return t},next:function(){for(var a=w.currentTime(),b=0;b<t.length;b++){var c=r.markerTip.time(t[b]);if(c>a){w.currentTime(c);break}}},prev:function(){for(var a=w.currentTime(),b=t.length-1;b>=0;b--){var c=r.markerTip.time(t[b]);if(c+.5<a){w.currentTime(c);break}}},add:function(a){e(a)},remove:function(a){j(a)},removeAll:function(){for(var a=[],b=0;b<t.length;b++)a.push(b);j(a)},updateTime:function(){i()},reset:function(a){w.markers.removeAll(),e(a)},destroy:function(){w.markers.removeAll(),x&&x.remove(),w.off("timeupdate",m),delete w.markers}}}var f={activeHighlightTimeout:1,markerStyle:{width:"7px","border-radius":"30%","background-color":"red"},markerTip:{clickable:!0,display:!0,text:function(a){return"Break: "+a.text},time:function(a){return a.time}},breakOverlay:{display:!1,displayTime:3,text:function(a){return"Break overlay: "+a.overlayText},style:{width:"100%",height:"20%","background-color":"rgba(0,0,0,0.7)",color:"white","font-size":"17px"}},onMarkerClick:function(a){},onMarkerReached:function(a){},markers:[]};b.plugin("markers",e)}(jQuery,window.videojs);